import { getDefaultConfig } from '@rainbow-me/rainbowkit';
import { sepolia } from 'wagmi/chains';

// ========== å¢å¼ºç‰ˆåˆçº¦åœ°å€ (2025-06-13éƒ¨ç½²) ==========
export const SHT_TOKEN_ADDRESS = process.env.NEXT_PUBLIC_SHT_TOKEN_ADDRESS as `0x${string}` || '0xe2241E16949d01356bA43D9401D3775E29Ea9F4c';
export const PROMPT_NFT_ADDRESS = process.env.NEXT_PUBLIC_PROMPT_NFT_ADDRESS as `0x${string}` || '0xB6Cd40E35C212fA5b3064ba5834b4E0C264f91C3';
export const MARKETPLACE_ADDRESS = process.env.NEXT_PUBLIC_MARKETPLACE_ADDRESS as `0x${string}` || '0xafC64D6c863aa7C54F07488fBf70cf9646a49963';

// ç½‘ç»œé…ç½®
export const targetChain = sepolia;

// RainbowKité…ç½®
export const config = getDefaultConfig({
  appName: process.env.NEXT_PUBLIC_APP_NAME || 'ç¥å›¾è®¡åˆ’ ShanHaiVerse',
  projectId: process.env.NEXT_PUBLIC_WALLETCONNECT_PROJECT_ID || '',
  chains: [sepolia],
  ssr: true,
});

// ========== å¢å¼ºç‰ˆ SHT Token ABI ==========
export const ENHANCED_SHT_TOKEN_ABI = [
  // åŸºç¡€ERC20åŠŸèƒ½
  {
    "inputs": [{"internalType": "address","name": "account","type": "address"}],
    "name": "balanceOf",
    "outputs": [{"internalType": "uint256","name": "","type": "uint256"}],
    "stateMutability": "view",
    "type": "function"
  },
  {
    "inputs": [],
    "name": "totalSupply",
    "outputs": [{"internalType": "uint256","name": "","type": "uint256"}],
    "stateMutability": "view",
    "type": "function"
  },
  
  // åŸæœ‰å¥–åŠ±åŠŸèƒ½
  {
    "inputs": [],
    "name": "claimDailyReward",
    "outputs": [],
    "stateMutability": "nonpayable",
    "type": "function"
  },
  {
    "inputs": [{"internalType": "address","name": "user","type": "address"}],
    "name": "canClaimToday",
    "outputs": [{"internalType": "bool","name": "","type": "bool"}],
    "stateMutability": "view",
    "type": "function"
  },
  
  // ========== ğŸ†• æ–°å¢åŠŸèƒ½ ==========
  
  // NFTæŒæœ‰è€…å¥–åŠ±
  {
    "inputs": [],
    "name": "claimNFTHolderReward",
    "outputs": [],
    "stateMutability": "nonpayable",
    "type": "function"
  },
  {
    "inputs": [{"internalType": "address","name": "user","type": "address"}],
    "name": "canClaimNFTRewardToday",
    "outputs": [{"internalType": "bool","name": "","type": "bool"}],
    "stateMutability": "view",
    "type": "function"
  },
  
  // ä¸€é”®é¢†å–æ‰€æœ‰å¥–åŠ±
  {
    "inputs": [],
    "name": "claimAllRewards",
    "outputs": [],
    "stateMutability": "nonpayable",
    "type": "function"
  },
  
  // å¢å¼ºæŸ¥è¯¢åŠŸèƒ½
  {
    "inputs": [{"internalType": "address","name": "user","type": "address"}],
    "name": "getAvailableRewards",
    "outputs": [
      {"internalType": "bool","name": "canClaimDaily","type": "bool"},
      {"internalType": "bool","name": "canClaimNFT","type": "bool"},
      {"internalType": "uint256","name": "dailyAmount","type": "uint256"},
      {"internalType": "uint256","name": "nftAmount","type": "uint256"},
      {"internalType": "uint256","name": "nftBalance","type": "uint256"}
    ],
    "stateMutability": "view",
    "type": "function"
  },
  
  // å¢å¼ºç”¨æˆ·ç»Ÿè®¡
  {
    "inputs": [{"internalType": "address","name": "user","type": "address"}],
    "name": "getUserStats",
    "outputs": [
      {
        "components": [
          {"internalType": "uint256","name": "lastClaimTime","type": "uint256"},
          {"internalType": "uint256","name": "lastNFTClaimTime","type": "uint256"},
          {"internalType": "uint256","name": "consecutiveDays","type": "uint256"},
          {"internalType": "uint256","name": "totalClaimed","type": "uint256"},
          {"internalType": "uint256","name": "totalNFTRewards","type": "uint256"},
          {"internalType": "uint256","name": "mintCount","type": "uint256"}
        ],
        "internalType": "struct ShanHaiToken.UserStats",
        "name": "",
        "type": "tuple"
      }
    ],
    "stateMutability": "view",
    "type": "function"
  },
  
  // æ—¶é—´æŸ¥è¯¢
  {
    "inputs": [{"internalType": "address","name": "user","type": "address"}],
    "name": "getNextClaimTime",
    "outputs": [{"internalType": "uint256","name": "","type": "uint256"}],
    "stateMutability": "view",
    "type": "function"
  },
  {
    "inputs": [{"internalType": "address","name": "user","type": "address"}],
    "name": "getNextNFTClaimTime",
    "outputs": [{"internalType": "uint256","name": "","type": "uint256"}],
    "stateMutability": "view",
    "type": "function"
  },
  
  // NFTåˆçº¦åœ°å€
  {
    "inputs": [],
    "name": "shanHaiNFTAddress",
    "outputs": [{"internalType": "address","name": "","type": "address"}],
    "stateMutability": "view",
    "type": "function"
  },
  
  // å¥–åŠ±å¸¸é‡
  {
    "inputs": [],
    "name": "DAILY_REWARD",
    "outputs": [{"internalType": "uint256","name": "","type": "uint256"}],
    "stateMutability": "view",
    "type": "function"
  },
  {
    "inputs": [],
    "name": "NFT_HOLDER_REWARD",
    "outputs": [{"internalType": "uint256","name": "","type": "uint256"}],
    "stateMutability": "view",
    "type": "function"
  },
  {
    "inputs": [],
    "name": "MINT_REWARD",
    "outputs": [{"internalType": "uint256","name": "","type": "uint256"}],
    "stateMutability": "view",
    "type": "function"
  }
] as const;

// ä¿æŒåŸæœ‰çš„NFTå’ŒMarketplace ABIä¸å˜
export const PROMPT_NFT_ABI = [
  {
    "inputs": [
      {"internalType": "address","name": "to","type": "address"},
      {"internalType": "string","name": "prompt","type": "string"}
    ],
    "name": "mint",
    "outputs": [{"internalType": "uint256","name": "","type": "uint256"}],
    "stateMutability": "payable",
    "type": "function"
  },
  {
    "inputs": [{"internalType": "address","name": "owner","type": "address"}],
    "name": "balanceOf",
    "outputs": [{"internalType": "uint256","name": "","type": "uint256"}],
    "stateMutability": "view",
    "type": "function"
  },
  {
    "inputs": [{"internalType": "uint256","name": "tokenId","type": "uint256"}],
    "name": "getBeastInfo",
    "outputs": [
      {
        "components": [
          {"internalType": "string","name": "prompt","type": "string"},
          {"internalType": "string","name": "ipfsImageUrl","type": "string"},
          {"internalType": "string","name": "ipfsMetadataUrl","type": "string"},
          {"internalType": "uint8","name": "rarity","type": "uint8"},
          {"internalType": "uint256","name": "timestamp","type": "uint256"},
          {"internalType": "address","name": "creator","type": "address"},
          {"internalType": "bool","name": "rarityRevealed","type": "bool"},
          {"internalType": "bool","name": "hasIPFS","type": "bool"}
        ],
        "internalType": "struct ShanHaiNFT.ShanHaiBeast",
        "name": "",
        "type": "tuple"
      }
    ],
    "stateMutability": "view",
    "type": "function"
  },
  {
    "inputs": [{"internalType": "address","name": "user","type": "address"}],
    "name": "getUserBeasts",
    "outputs": [{"internalType": "uint256[]","name": "","type": "uint256[]"}],
    "stateMutability": "view",
    "type": "function"
  },
  {
    "inputs": [],
    "name": "getRarityDistribution",
    "outputs": [{"internalType": "uint256[5]","name": "","type": "uint256[5]"}],
    "stateMutability": "view",
    "type": "function"
  },
  {
    "inputs": [{"internalType": "uint256","name": "tokenId","type": "uint256"}],
    "name": "ownerOf",
    "outputs": [{"internalType": "address","name": "","type": "address"}],
    "stateMutability": "view",
    "type": "function"
  }
] as const;

export const MARKETPLACE_ABI = [
  {
    "inputs": [
      {"internalType": "uint256","name": "tokenId","type": "uint256"},
      {"internalType": "uint256","name": "price","type": "uint256"}
    ],
    "name": "listItem",
    "outputs": [],
    "stateMutability": "nonpayable",
    "type": "function"
  },
  {
    "inputs": [{"internalType": "uint256","name": "tokenId","type": "uint256"}],
    "name": "buyItem",
    "outputs": [],
    "stateMutability": "nonpayable",
    "type": "function"
  },
  {
    "inputs": [
      {"internalType": "uint256","name": "offset","type": "uint256"},
      {"internalType": "uint256","name": "limit","type": "uint256"}
    ],
    "name": "getActiveListings",
    "outputs": [
      {
        "components": [
          {"internalType": "uint256","name": "tokenId","type": "uint256"},
          {"internalType": "address","name": "seller","type": "address"},
          {"internalType": "uint256","name": "price","type": "uint256"},
          {"internalType": "uint256","name": "timestamp","type": "uint256"},
          {"internalType": "bool","name": "active","type": "bool"}
        ],
        "internalType": "struct ShanHaiMarketplace.Listing[]",
        "name": "",
        "type": "tuple[]"
      }
    ],
    "stateMutability": "view",
    "type": "function"
  },
  {
    "inputs": [],
    "name": "getMarketStats",
    "outputs": [
      {"internalType": "uint256","name": "_totalListings","type": "uint256"},
      {"internalType": "uint256","name": "_totalSales","type": "uint256"},
      {"internalType": "uint256","name": "_totalVolume","type": "uint256"},
      {"internalType": "uint256","name": "_marketFee","type": "uint256"}
    ],
    "stateMutability": "view",
    "type": "function"
  }
] as const;

// ========== å¢å¼ºç‰ˆåŠŸèƒ½å¸¸é‡ ==========
export const REWARD_CONSTANTS = {
  DAILY_REWARD: 100, // 100 SHT
  NFT_HOLDER_REWARD: 100, // 100 SHT
  MINT_REWARD: 50, // 50 SHT
  COOLDOWN_HOURS: 24,
  MAX_CONSECUTIVE_BONUS: 50, // 50%
  CONSECUTIVE_BONUS_DAYS: 7
} as const;

// ç¨€æœ‰åº¦å®šä¹‰
export const RARITY_NAMES = ['æ™®é€š', 'ç¨€æœ‰', 'å²è¯—', 'ä¼ è¯´', 'ç¥è¯'] as const;
export const RARITY_COLORS = {
  0: 'text-gray-600',   // æ™®é€š
  1: 'text-blue-600',   // ç¨€æœ‰
  2: 'text-purple-600', // å²è¯—
  3: 'text-orange-600', // ä¼ è¯´
  4: 'text-red-600',    // ç¥è¯
} as const;

// ========== å…¼å®¹æ€§åˆ«å ==========
// ä¿æŒå‘åå…¼å®¹
export const SHT_TOKEN_ABI = ENHANCED_SHT_TOKEN_ABI;

// ========== åˆçº¦éªŒè¯é“¾æ¥ ==========
export const ETHERSCAN_LINKS = {
  SHT_TOKEN: `https://sepolia.etherscan.io/address/${SHT_TOKEN_ADDRESS}`,
  PROMPT_NFT: `https://sepolia.etherscan.io/address/${PROMPT_NFT_ADDRESS}`,
  MARKETPLACE: `https://sepolia.etherscan.io/address/${MARKETPLACE_ADDRESS}`,
} as const;